# 航迹管理模块 | TrackManager
一个简单的类，用来管理航迹并进行可视化。

---
## 环境依赖
  - openCV (v4.13.0)
  - Catch2 (v3.x) 仅测试用，可选
---
## 项目概述
1. **使用方式**
   - 所有对外接口函数均在include文件下，引用trackerManager.hpp即可。编译CPP文件以LIB方式提供服务
   - 测试文件在tests文件夹下
2. **文件结构**
   - 头文件 [`include`](./include/)
   - 源文件 [`src`](./src/)
   - 三方库 [`utils`](./utils/)
   - 测试代码 [`tests`](./tests/)
   - 自动构建脚本 [`bmain.sh`](./bmain.sh)：
3. **代码结构**
4. - 泛型环形存储容器： **latestKbuffer\<T\>**
     - 循环存储，自动覆盖旧数据；能定点修改航迹点
   - 航迹管理层：**TrackManager**
     - 航迹记录（数据层）、终结管理；事务管理；
     - 调用latestKbuffer\<trackerContainer\>实现
   - 可视化组件：**TrackVisualizer**
     - 可插拔DEBUG组件，用于显示航迹，由宏定义启用，否则为空函数
     - 读取pack的包，日志记录并可视化
     - 读取点迹包，可视化
   - 管理服务层：**ManagementService**
     - 环形存储器里面含有一个含有航迹新点的包和一个含有点迹新航迹的包，输出pack后的完备航迹信息
     - 调用TrackManager和TrackVisualizer实现

## 开发日志  
### 2025-10-24 至 2025-10-25
1. **项目框架搭建**
2. **开发工具链集成**
   - 完成VSCode集成GDB调试
   - Git 版本控制（已配置 `.gitignore` 过滤构建产物）
3. **结构设计**
   - latestKbuffer\<T\> ：泛型环形存储容器：循环存储，自动覆盖旧数据；能定点修改航迹点
   - TrackManager - 航迹生命周期管理器：航迹记录（数据层）、终结管理；事务管理；
   - trackshow -可视化窗口：DEBUG功能用于显示航迹，两个函数接口，读取trackManager的航迹并可视化，另一个是读取外部输入的点迹进行可视化

### 2025-10-26 至 2025-10-26
1. **构建数据层：latestKbuffer\<T\>**
  - 基于环形缓冲区思路设计，仅保留最新的k个数据，数据满的时候自动弹出
  - 目前设计为禁止拷贝容器
  - 仅允许追加写入新x数据和定点修改数据，禁止移除数据**(已移除该功能放到应用层实现)**
  - 批量拷贝输出：智能内存拷贝策略，POD类型使用memcpy，非POD类型使用安全循环
  
### 2025-10-27 至 2025-11-2
1. 删除计算层：由卡尔曼滤波提供外推结果
   - 设计动机：为解决模块间紧耦合问题，提升系统可拆卸性与可维护性，放弃传统的计算层设计。
   - 统一缓冲区结构，航迹结构放到defstruct里面去，缓冲区结构
   - 设计指令结构用于各层通信
2. **航迹管理层设计**
   - 调用latestKBuffer，设计内存池
   - 提供航迹创建，航迹删除，航迹合并（同传感器合批），航迹输出服务
   - 提供航迹更新功能，且自动实现单群识别，航迹判断
   - 支持一键初始化所有航迹
  
### 2025-11-3 至 2025-11-04
1. **日志库**
    - 添加./utils三方库，输出日志
    - 依旧支持插拔设计和异常检测
    - 暂时还没有支持args的写入，等待后续完善
2. 添加友元TrackerManagerDebugger实现航迹管理层调试功能
3. **管理服务层**
    - 去耦合，将对外接口重构为新服务层，组合调用可视化插件，日志插件和航迹管理层
    - 和流水线结构对接，前后端分离
4. 准备重写DEFSTRUCT，完善流水线设计思路

  
### 2025-11-05 至 2025-11-06
1. 完成defstruct流水线结构设计
    - 统一了缓冲区结构，将航迹结构整合到defstruct中
    - 设计了指令结构用于各层间通信，提升模块解耦性
2. 代码质量优化与警告消除
    - 启用三级编译警告（基础警告、UB检测、代码质量），截至11.06没有WARNING了
    - 修复了所有类型转换警告，将非内存相关的size_t统一为uint32_t，（基础数据类型任然支持size_t）
3. 确保跨平台数据类型一致性，为未来流水线分离做准备
    - 完成压力测试与性能验证：RELEASE下：
    - 航迹创建: 10.77 μs/个 (2000空航迹)
    - 航迹删除: 10.46 μs/个 (2000满载航迹)
    - 点迹写入: 0.0145 μs/点 (400万点迹)
    - 数据打包: 14.19 ms (244MB数据)
    - 所有核心操作性能均衡，内存池设计达到预期效果
4. 准备开始可视化插件（优先），日志插件（尤其是把string修改为args这个有点急），以及流水线兼容的设计
